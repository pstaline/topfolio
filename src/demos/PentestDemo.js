import React, { useState } from 'react';
import './DemoStyles.css';

const PentestDemo = () => {
  const [activeTab, setActiveTab] = useState('scanner');
  const [target, setTarget] = useState('192.168.1.100');
  const [scanning, setScanning] = useState(false);
  const [results, setResults] = useState([]);

  const tools = [
    { id: 'scanner', name: 'Port Scanner', icon: 'üîç' },
    { id: 'vuln', name: 'Vulnerability Scanner', icon: '‚ö†Ô∏è' },
    { id: 'exploit', name: 'Exploit Database', icon: 'üí£' },
    { id: 'report', name: 'Report Generator', icon: 'üìã' }
  ];

  const vulnerabilities = [
    { 
      id: 1, 
      name: 'SQL Injection', 
      severity: 'Critical', 
      cvss: 9.8,
      description: 'Improper input validation allows SQL injection attacks',
      remediation: 'Use prepared statements and parameterized queries'
    },
    { 
      id: 2, 
      name: 'Cross-Site Scripting (XSS)', 
      severity: 'High', 
      cvss: 7.2,
      description: 'Reflected XSS vulnerability in search parameter',
      remediation: 'Implement proper input sanitization and output encoding'
    },
    { 
      id: 3, 
      name: 'Weak Authentication', 
      severity: 'High', 
      cvss: 8.1,
      description: 'No account lockout mechanism detected',
      remediation: 'Implement rate limiting and account lockout policies'
    },
    { 
      id: 4, 
      name: 'Outdated Software', 
      severity: 'Medium', 
      cvss: 5.3,
      description: 'Apache 2.4.41 contains known vulnerabilities',
      remediation: 'Update to latest stable version'
    }
  ];

  const scanPorts = () => {
    setScanning(true);
    setResults([]);
    const ports = [
      { port: 22, service: 'SSH', status: 'open', version: 'OpenSSH 8.2' },
      { port: 80, service: 'HTTP', status: 'open', version: 'Apache 2.4.41' },
      { port: 443, service: 'HTTPS', status: 'open', version: 'Apache 2.4.41' },
      { port: 3306, service: 'MySQL', status: 'open', version: 'MySQL 8.0' },
      { port: 21, service: 'FTP', status: 'filtered', version: 'N/A' },
      { port: 25, service: 'SMTP', status: 'closed', version: 'N/A' }
    ];

    let index = 0;
    const interval = setInterval(() => {
      if (index < ports.length) {
        setResults(prev => [...prev, ports[index]]);
        index++;
      } else {
        clearInterval(interval);
        setScanning(false);
      }
    }, 500);
  };

  const exploits = [
    { 
      id: 'EXP-2024-001', 
      name: 'Apache Struts RCE', 
      target: 'Apache Struts 2.x', 
      severity: 'Critical' 
    },
    { 
      id: 'EXP-2024-002', 
      name: 'WordPress Plugin SQLi', 
      target: 'WordPress < 6.0', 
      severity: 'High' 
    },
    { 
      id: 'EXP-2024-003', 
      name: 'OpenSSL Heartbleed', 
      target: 'OpenSSL 1.0.1', 
      severity: 'Critical' 
    }
  ];

  return (
    <div className="demo pentest-demo">
      <h4>üéØ Penetration Testing Toolkit</h4>
      
      <div className="tools-tabs">
        {tools.map(tool => (
          <button
            key={tool.id}
            className={`tool-tab ${activeTab === tool.id ? 'active' : ''}`}
            onClick={() => setActiveTab(tool.id)}
          >
            {tool.icon} {tool.name}
          </button>
        ))}
      </div>

      {activeTab === 'scanner' && (
        <div className="tool-content">
          <div className="target-input">
            <label>Target IP/Domain:</label>
            <input
              type="text"
              value={target}
              onChange={(e) => setTarget(e.target.value)}
              placeholder="192.168.1.100"
              className="input-field"
            />
            <button onClick={scanPorts} disabled={scanning} className="scan-btn">
              {scanning ? '‚è≥ Scanning...' : 'üöÄ Start Scan'}
            </button>
          </div>

          {results.length > 0 && (
            <div className="scan-results">
              <h5>Port Scan Results</h5>
              <div className="results-table">
                <div className="table-header">
                  <span>Port</span>
                  <span>Service</span>
                  <span>Status</span>
                  <span>Version</span>
                </div>
                {results.map((result, idx) => (
                  <div key={idx} className="table-row">
                    <span className="port-number">{result.port}</span>
                    <span>{result.service}</span>
                    <span className={`status-${result.status}`}>{result.status}</span>
                    <span className="version">{result.version}</span>
                  </div>
                ))}
              </div>
            </div>
          )}
        </div>
      )}

      {activeTab === 'vuln' && (
        <div className="tool-content">
          <div className="vuln-scanner">
            <h5>üîç Detected Vulnerabilities</h5>
            <div className="vuln-list">
              {vulnerabilities.map(vuln => (
                <div key={vuln.id} className={`vuln-card ${vuln.severity.toLowerCase()}`}>
                  <div className="vuln-header">
                    <h6>{vuln.name}</h6>
                    <span className={`severity-badge ${vuln.severity.toLowerCase()}`}>
                      {vuln.severity}
                    </span>
                  </div>
                  <div className="cvss-score">
                    <strong>CVSS Score:</strong> {vuln.cvss}/10
                  </div>
                  <div className="vuln-description">
                    <strong>Description:</strong> {vuln.description}
                  </div>
                  <div className="vuln-remediation">
                    <strong>Remediation:</strong> {vuln.remediation}
                  </div>
                </div>
              ))}
            </div>
          </div>
        </div>
      )}

      {activeTab === 'exploit' && (
        <div className="tool-content">
          <div className="exploit-db">
            <h5>üí£ Exploit Database</h5>
            <div className="exploits-list">
              {exploits.map(exploit => (
                <div key={exploit.id} className="exploit-card">
                  <div className="exploit-header">
                    <span className="exploit-id">{exploit.id}</span>
                    <span className={`severity-badge ${exploit.severity.toLowerCase()}`}>
                      {exploit.severity}
                    </span>
                  </div>
                  <h6>{exploit.name}</h6>
                  <div className="exploit-target">Target: {exploit.target}</div>
                  <button className="exploit-btn">View Details</button>
                </div>
              ))}
            </div>
          </div>
        </div>
      )}

      {activeTab === 'report' && (
        <div className="tool-content">
          <div className="report-section">
            <h5>üìã Penetration Test Report</h5>
            <div className="report-summary">
              <div className="summary-card critical">
                <div className="summary-value">2</div>
                <div className="summary-label">Critical</div>
              </div>
              <div className="summary-card high">
                <div className="summary-value">2</div>
                <div className="summary-label">High</div>
              </div>
              <div className="summary-card medium">
                <div className="summary-value">1</div>
                <div className="summary-label">Medium</div>
              </div>
              <div className="summary-card low">
                <div className="summary-value">0</div>
                <div className="summary-label">Low</div>
              </div>
            </div>
            <button className="download-btn">üì• Download Full Report (PDF)</button>
          </div>
        </div>
      )}
    </div>
  );
};

export default PentestDemo;
